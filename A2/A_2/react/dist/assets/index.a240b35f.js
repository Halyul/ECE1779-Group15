import{b as me,g as ee,e as he,u as fe,r as u,a as o,j as e,N as p,O as pe,F as P,f as ge,h as ye,i as v,k as xe,l as ve,m as te,n as be,o as ke,p as Se,q as f,c as Te,s as Ce}from"./react.d47cd063.js";import{u as De,a as we,c as Oe,T as Re,C as Pe,B as h,A as _e,b as U,I as _,d as g,e as m,L as Ie,S as $e,f as I,g as $,h as Ee,i as E,j as b,k,l as S,m as L,n as Le,r as G,o as Me,p as je,q as Ne,D as Be,s as Fe,t as Ke,v as Ae,w as qe,x as ze,y as W,z as He,E as ae,G as C,F as ne,H as Ue}from"./mui.f7224c7a.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();var w={},V=me.exports;w.createRoot=V.createRoot,w.hydrateRoot=V.hydrateRoot;var M={},T={exports:{}};(function(t){function a(n){return n&&n.__esModule?n:{default:n}}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports})(T);var D={};const Ge=ee(De);var X;function j(){return X||(X=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.createSvgIcon}});var a=Ge}(D)),D}const N=ee(he);var We=T.exports;Object.defineProperty(M,"__esModule",{value:!0});var re=M.default=void 0,Ve=We(j()),Xe=N,Qe=(0,Ve.default)((0,Xe.jsx)("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu");re=M.default=Qe;const Ze=240;function Je(t){const a=fe(),[n,i]=u.exports.useState(!1),s=we("(prefers-color-scheme: dark)"),r=u.exports.useMemo(()=>Oe({palette:{mode:s?"dark":"light"}}),[s]),l=()=>{i(!n)};return o(Re,{theme:r,children:[e(Pe,{}),o(h,{sx:{display:"flex",minHeight:"inherit"},children:[o(_e,{component:"nav",children:[o(U,{children:[e(_,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:l,sx:{mr:2,display:{md:"none"}},children:e(re,{})}),e(g,{variant:"h6",component:"div",sx:{flexGrow:1},children:t.title}),e(h,{sx:{display:{xs:"none",md:"block"}},children:t.destinations.map(c=>e(m,{sx:{color:"#fff"},children:e(p,{to:c.path,children:c.name})},c.name))})]}),e(h,{sx:{width:"100%"},hidden:a.state!=="loading",children:e(Ie,{})})]}),e(h,{component:"nav",children:e($e,{container:document.body,variant:"temporary",open:n,onClose:l,onOpen:l,ModalProps:{keepMounted:!0},sx:{display:{md:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:Ze}},children:e(h,{onClick:l,sx:{textAlign:"center"},children:e(I,{children:t.destinations.map(c=>e(p,{to:c.path,children:e($,{disablePadding:!0,children:e(Ee,{sx:{textAlign:"center"},children:e(E,{primary:c.name})})})},c.name))})})})}),o(h,{component:"main",sx:{height:"inherit",width:"90vw",maxWidth:"768px !important",margin:"0 auto"},children:[e(U,{sx:{marginBottom:"16px"}}),e(pe,{})]})]})]})}var B={},Ye=T.exports;Object.defineProperty(B,"__esModule",{value:!0});var se=B.default=void 0,et=Ye(j()),tt=N,at=(0,et.default)((0,tt.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");se=B.default=at;function O(t){return o(b,{sx:{marginBottom:"1rem"},children:[e(k,{title:t.title}),e(S,{children:t.body}),t.actions&&e(L,{children:t.actions.map(a=>e(m,{size:"small",onClick:a.onClick,children:a.content},a.label))})]})}function nt(t){return o(b,{sx:{marginBottom:"1rem"},children:[e(P,{method:"POST",id:"image-form",children:e(k,{action:e(_,{"aria-label":"refresh",type:"submit",onClick:t.handleOnClick,children:e(se,{})}),title:t.title,subheader:t.subtitle})}),e(S,{children:t.body})]})}function Q(){const t=ge(),a=ye();return console.error(t),e(Le,{sx:{maxWidth:"768px !important",width:"90vw",height:"inherit",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"stretch"},children:e(O,{title:`${t.status} ${t.data?t.statusText:""}`,body:e(g,{variant:"body1",children:t.data?t.data:t.statusText}),actions:[{label:"Go back",content:"Go back",onClick:()=>{a(-1)}}]})})}const rt=[{color:G[500],name:"Teng Shu",responsibility:"Backend Developer"},{color:Me[500],name:"Haoyu Xu",responsibility:"Frontend Developer"},{color:G[500],name:"Xiaoyu Zhai",responsibility:"Backend Developer"}];function st(){return o(v,{children:[e(O,{title:"Welcome",body:e(g,{variant:"body1",children:"Please select a destination from the menu."})}),e(O,{title:"Members",body:e(I,{sx:{width:"100%",bgcolor:"background.paper"},children:rt.map(t=>o(h,{children:[o($,{alignItems:"flex-start",children:[e(je,{children:e(Ne,{sx:{bgcolor:t.color},children:t.name.split(" ").map(a=>a[0]).join("")})}),e(E,{primary:t.name,secondary:e(g,{sx:{display:"inline"},component:"div",variant:"body2",color:"text.primary",children:t.responsibility})})]}),e(Be,{variant:"inset",component:"li"})]},t.name))})})]})}const it={name:"Home",path:""};async function ot(t){const a=new FormData;for(const i in t)a.append(i,t[i]);const n=await K("/api/upload",{method:"POST",body:a});return F(n)}async function lt(){const t=await K("/api/list_keys",{method:"POST"});return F(t)}async function ct(t){const a=await K(`/api/key/${t}`,{method:"POST"});return F(a)}function F(t){const a=t;return a.success=a.success==="true",a}async function K(t="",a={}){return fetch(t,a).then(n=>n.ok?n.json().then(i=>({data:i,status:n.status,statusText:n.statusText})):Promise.reject(n)).catch(n=>(console.error("Error:",n),n.message?{data:{success:!1,message:n.message},status:500,statusText:n.message}:n.json().then(i=>({data:{success:n.ok,message:i.error.message},status:n.status,statusText:n.statusText}))))}function ie(t){const[a,n]=u.exports.useState(!1),[i,s]=u.exports.useState(!1);u.exports.useEffect(()=>{t.submissionStatus&&(t.submitting.setOpen(!1),t.submissionStatus.status!==200?s(!0):n(!0))},[t.submissionStatus]);const r=()=>{s(!1)},l=()=>{n(!1)};return o(v,{children:[o(Fe,{open:i,onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e(Ke,{id:"alert-dialog-title",children:t.failed.title}),e(Ae,{children:e(qe,{id:"alert-dialog-description",children:t.failed.text})}),e(ze,{children:e(m,{onClick:r,children:"Close"})})]}),e(W,{open:t.submitting.open,message:t.submitting.text}),e(W,{open:a,message:t.submittedText,autoHideDuration:6e3,onClose:l})]})}function R(t){return e(He,{open:t.open,onBlur:()=>t.handleClose(),disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,title:t.title,children:t.body})}async function ut({request:t,params:a}){const n=await t.formData(),i=Object.fromEntries(n),s=await ot(i);return{status:s.status,statusText:s.statusText}}function dt(){const t=xe(),[a,n]=ve(),[i,s]=u.exports.useState("Select a file"),[r,l]=u.exports.useState(null),[c,le]=u.exports.useState(a.get("key")||""),[ce,q]=u.exports.useState(!1),[z,y]=u.exports.useState(!1),[H,x]=u.exports.useState(!1),[ue,de]=u.exports.useState(!1);return u.exports.useEffect(()=>{t&&t.status===200&&de(!0)},[t]),o(v,{children:[o(b,{children:[r&&e(ae,{component:"img",image:r}),e(k,{title:"Upload"}),o(P,{method:"POST",id:"upload-form",encType:"multipart/form-data",onSubmit:d=>{q(!0)},children:[e(S,{children:o(C,{container:!0,spacing:2,children:[e(C,{item:!0,xs:12,children:e(R,{open:z,handleClose:()=>y(!1),title:"Please enter a key, spaces are NOT allowed. More than 48 characters are NOT allowed.",body:e(ne,{id:"upload-form-key",name:"key",label:"Enter a key",variant:"outlined",fullWidth:!0,error:z,value:c,onChange:d=>{d.target.value.includes(" ")||d.target.value.length>48?y(!0):(le(d.target.value),y(!1))}})})},"key"),e(C,{item:!0,xs:12,children:e(R,{open:H,handleClose:()=>x(!1),title:"Please select a file",body:o(m,{variant:"outlined",component:"label",fullWidth:!0,color:H?"error":"primary",children:[i,e("input",{hidden:!0,accept:"image/*",type:"file",name:"file",onChange:d=>{d.target.files.length>0?(s(`Selected: ${d.target.files[0].name}`),l(URL.createObjectURL(d.target.files[0])),x(!1)):(s("Select a file"),l(null),x(!0))}})]})})},"file")]})}),o(L,{children:[e(m,{size:"small",type:"submit",onClick:d=>{(c===""||c.includes(" ")||c.length>48)&&(y(!0),d.preventDefault()),i==="Select a file"&&(x(!0),d.preventDefault())},children:"Submit"}),ue&&e(p,{to:`../image/${c}`,style:{marginLeft:"auto"},children:e(m,{size:"small",children:"Take a look"})})]})]})]}),e(ie,{failed:{title:"Failed to upload the image",text:t==null?void 0:t.statusText},submitting:{text:"Image is uploading...",open:ce,setOpen:q},submittedText:"Image uploaded successfully",submissionStatus:t})]})}const Z={name:"Upload",path:"upload"};async function mt({params:t}){const a=await ct(t.key);return a.status!==200?{status:a.status,details:{message:a.data.message,statusText:a.statusText}}:{status:200,image:{content:a.data.content,key:t.key}}}async function ht({request:t,params:a}){const n=await t.formData(),i=Object.fromEntries(n);return be(`/image/${i.key}`)}function ft(){const t=te(),[a,n]=u.exports.useState(!1),[i,s]=u.exports.useState("");let r=null,l=null;return t&&(t.status===200?r=t.image:l=t),o(b,{children:[r&&e(ae,{component:"img",image:r.content,alt:r.key}),e(k,{title:l&&`${l.status} ${l.details.statusText}`||"Image Key",subheader:r&&r.key||l&&l.details.message||"Key is not presented. Please provide a key."}),o(P,{method:"POST",id:"image-form",children:[e(S,{children:e(R,{open:a,handleClose:()=>n(!1),title:"Please enter a key wihtout spaces. More than 48 characters are NOT allowed.",body:e(ne,{id:"image-text-field",name:"key",label:(r||l)&&"Enter another image key"||"Enter an image key",variant:"outlined",fullWidth:!0,error:a,value:i,onChange:c=>{c.target.value.includes(" ")||c.target.value.length>48?n(!0):(s(c.target.value),n(!1))}})})}),o(L,{children:[e(m,{size:"small",type:"submit",onClick:c=>{(i===""||i.includes(" ")||i.length>48)&&(n(!0),c.preventDefault())},children:"Submit"}),r&&e(p,{to:`../upload/?key=${r.key}`,style:{marginLeft:"auto"},children:e(m,{size:"small",children:"Re-upload"})})]})]})]})}const J={name:"Image with Key",path:"image/:key"};var A={},pt=T.exports;Object.defineProperty(A,"__esModule",{value:!0});var oe=A.default=void 0,gt=pt(j()),yt=N,xt=(0,gt.default)((0,yt.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");oe=A.default=xt;async function vt({params:t}){return await lt()}async function bt({request:t,params:a}){}function kt(){const t=te(),[a,n]=u.exports.useState(t.data.keys),[i,s]=u.exports.useState(!1);return u.exports.useEffect(()=>{s(!1),n(t.data.keys)},[t]),o(v,{children:[e(nt,{title:"Keys",body:a.length>0?e(I,{children:a.map(r=>e($,{secondaryAction:e(p,{to:`../image/${r}`,children:e(_,{edge:"end","aria-label":`Go to image with key ${r}`,children:e(oe,{})})}),children:e(E,{primary:r})},r))}):e(g,{variant:"body1",children:"No keys found."}),handleOnClick:()=>{s(!0)}}),e(ie,{failed:{title:"Failed to retrieve keys",text:t==null?void 0:t.statusText},submitting:{text:"Retrieving...",open:i,setOpen:s},submittedText:"Key retrieved successfully",submissionStatus:t})]})}const Y={name:"Keys",path:"keys"};const St=ke(Se(e(f,{path:"/",element:e(Je,{title:"ECE1779 Group 15",destinations:[it,Z,J,Y]}),errorElement:e(Q,{}),children:o(f,{errorElement:e(Q,{}),children:[e(f,{index:!0,element:e(st,{})}),e(f,{path:Z.path,element:e(dt,{}),action:ut}),e(f,{path:J.path,element:e(ft,{}),loader:mt,action:ht}),e(f,{path:Y.path,element:e(kt,{}),loader:vt,action:bt})]})})));w.createRoot(document.getElementById("root")).render(e(Te.StrictMode,{children:e(Ue,{injectFirst:!0,children:e(Ce,{router:St})})}));
