import { useState, useEffect } from "react";
import { useLoaderData } from "react-router-dom";
import { RefreshCard } from "../components/card";
import SubmissionPrompt from "../components/submission-prompt";
import { getStatus } from "../libs/api";
import ECharts from "../components/echarts";

export async function loader({ params }) {
  const response = await getStatus();
  return response;
}

export async function action({ request, params }) {
  return;
}

export default function Status() {
  // const loaderResponse = useLoaderData();
  // const [statusList, setStatusList] = useState(loaderResponse.data.status);
  const [isRefreshing, setIsRefreshing] = useState(false);

  // useEffect(() => {
  //   setIsRefreshing(false);
  //   setStatusList(loaderResponse.data.status);
  // }, [loaderResponse]);
  return (
    <>
      <RefreshCard
        title="Status"
        subtitle="The status changes in last 30 minutes of the system"
        body={
          <>
            <ECharts
              title="Hit and Miss Rate"
              xAxis={[
                {
                  type: 'category',
                  data: ['2021-10-09', '2021-10-10', '2021-10-11', '2021-10-12', '2021-10-13', '2021-10-14', '2021-10-15', '2021-10-16', '2021-10-17', '2021-10-18', '2021-10-19', '2021-10-20', '2021-10-21', '2021-10-22', '2021-10-23', '2021-10-24', '2021-10-25', '2021-10-26', '2021-10-27', '2021-10-28', '2021-10-29', '2021-10-30', '2021-10-31', '2021-11-01', '2021-11-02', '2021-11-03', '2021-11-04', '2021-11-05', '2021-11-06', '2021-11-07', '2021-11-08', '2021-11-09', '2021-11-10', '2021-11-11', '2021-11-12', '2021-11-13', '2021-11-14', '2021-11-15', '2021-11-16', '2021-11-17', '2021-11-18', '2021-11-19', '2021-11-20', '2021-11-21', '2021-11-22', '2021-11-23', '2021-11-24', '2021-11-25', '2021-11-26']
                }
              ]}
              yAxis={[
                {
                  type: 'value',
                  axisLabel: {
                    formatter: '{value} %'
                  },
                }]
              }
              series={[
                {
                  name: 'Hit Rate',
                  data: [4168, 12441, 3297, 2801, 5465, 5609, 3907, 3487, 2967, 4988, 3620, 3648, 3635, 7262, 2138, 2177, 3431, 3424, 5990, 5262, 3882, 10322, 4370, 2621, 4715, 2951, 8873, 7002, 3711, 2692, 3106, 5574, 3381, 3430, 3492, 4225, 2738, 2048, 4196, 6041, 2918, 2366, 3848, 7078, 3129, 2387, 3252, 2626, 6399],
                  type: 'line',
                  smooth: true,
                },
                {
                  name: 'Miss Rate',
                  data: [168, 1241, 327, 281, 565, 569, 307, 387, 267, 988, 320, 348, 335, 722, 238, 217, 331, 344, 590, 262, 382, 122, 430, 221, 415, 251, 873, 702, 371, 292, 316, 554, 381, 340, 392, 425, 238, 48, 416, 61, 218, 236, 3848, 78, 319, 287, 3252, 2626, 699],
                  type: 'line',
                  smooth: true,
                }
              ]}
            />
            <ECharts
              title="Number of Items in Cache"
              xAxis={[
                {
                  type: 'category',
                  data: ['2021-10-09', '2021-10-10', '2021-10-11', '2021-10-12', '2021-10-13', '2021-10-14', '2021-10-15', '2021-10-16', '2021-10-17', '2021-10-18', '2021-10-19', '2021-10-20', '2021-10-21', '2021-10-22', '2021-10-23', '2021-10-24', '2021-10-25', '2021-10-26', '2021-10-27', '2021-10-28', '2021-10-29', '2021-10-30', '2021-10-31', '2021-11-01', '2021-11-02', '2021-11-03', '2021-11-04', '2021-11-05', '2021-11-06', '2021-11-07', '2021-11-08', '2021-11-09', '2021-11-10', '2021-11-11', '2021-11-12', '2021-11-13', '2021-11-14', '2021-11-15', '2021-11-16', '2021-11-17', '2021-11-18', '2021-11-19', '2021-11-20', '2021-11-21', '2021-11-22', '2021-11-23', '2021-11-24', '2021-11-25', '2021-11-26']
                }
              ]}
              yAxis={[
                {
                  type: 'value',
                }
              ]}
              series={[
                {
                  data: [4168, 12441, 3297, 2801, 5465, 5609, 3907, 3487, 2967, 4988, 3620, 3648, 3635, 7262, 2138, 2177, 3431, 3424, 5990, 5262, 3882, 10322, 4370, 2621, 4715, 2951, 8873, 7002, 3711, 2692, 3106, 5574, 3381, 3430, 3492, 4225, 2738, 2048, 4196, 6041, 2918, 2366, 3848, 7078, 3129, 2387, 3252, 2626, 6399],
                  type: 'line'
                }
              ]}
            />
            <ECharts
              title="Total Size of Items"
              xAxis={[
                {
                  type: 'category',
                  data: ['2021-10-09', '2021-10-10', '2021-10-11', '2021-10-12', '2021-10-13', '2021-10-14', '2021-10-15', '2021-10-16', '2021-10-17', '2021-10-18', '2021-10-19', '2021-10-20', '2021-10-21', '2021-10-22', '2021-10-23', '2021-10-24', '2021-10-25', '2021-10-26', '2021-10-27', '2021-10-28', '2021-10-29', '2021-10-30', '2021-10-31', '2021-11-01', '2021-11-02', '2021-11-03', '2021-11-04', '2021-11-05', '2021-11-06', '2021-11-07', '2021-11-08', '2021-11-09', '2021-11-10', '2021-11-11', '2021-11-12', '2021-11-13', '2021-11-14', '2021-11-15', '2021-11-16', '2021-11-17', '2021-11-18', '2021-11-19', '2021-11-20', '2021-11-21', '2021-11-22', '2021-11-23', '2021-11-24', '2021-11-25', '2021-11-26']
                }
              ]}
              yAxis={[
                {
                  type: 'value',
                  axisLabel: {
                    formatter: '{value} MB'
                  },
                }]
              }
              series={[
                {
                  data: [4168, 12441, 3297, 2801, 5465, 5609, 3907, 3487, 2967, 4988, 3620, 3648, 3635, 7262, 2138, 2177, 3431, 3424, 5990, 5262, 3882, 10322, 4370, 2621, 4715, 2951, 8873, 7002, 3711, 2692, 3106, 5574, 3381, 3430, 3492, 4225, 2738, 2048, 4196, 6041, 2918, 2366, 3848, 7078, 3129, 2387, 3252, 2626, 6399],
                  type: 'line'
                }
              ]}
            />
            <ECharts
              title="Number of Requests Served"
              xAxis={[
                {
                  type: 'category',
                  data: ['2021-10-09', '2021-10-10', '2021-10-11', '2021-10-12', '2021-10-13', '2021-10-14', '2021-10-15', '2021-10-16', '2021-10-17', '2021-10-18', '2021-10-19', '2021-10-20', '2021-10-21', '2021-10-22', '2021-10-23', '2021-10-24', '2021-10-25', '2021-10-26', '2021-10-27', '2021-10-28', '2021-10-29', '2021-10-30', '2021-10-31', '2021-11-01', '2021-11-02', '2021-11-03', '2021-11-04', '2021-11-05', '2021-11-06', '2021-11-07', '2021-11-08', '2021-11-09', '2021-11-10', '2021-11-11', '2021-11-12', '2021-11-13', '2021-11-14', '2021-11-15', '2021-11-16', '2021-11-17', '2021-11-18', '2021-11-19', '2021-11-20', '2021-11-21', '2021-11-22', '2021-11-23', '2021-11-24', '2021-11-25', '2021-11-26']
                }
              ]}
              yAxis={[
                {
                  type: 'value',
                }]
              }
              series={[
                {
                  data: [4168, 12441, 3297, 2801, 5465, 5609, 3907, 3487, 2967, 4988, 3620, 3648, 3635, 7262, 2138, 2177, 3431, 3424, 5990, 5262, 3882, 10322, 4370, 2621, 4715, 2951, 8873, 7002, 3711, 2692, 3106, 5574, 3381, 3430, 3492, 4225, 2738, 2048, 4196, 6041, 2918, 2366, 3848, 7078, 3129, 2387, 3252, 2626, 6399],
                  type: 'line'
                }
              ]}
            />
          </>
        }
      />
      {/* <SubmissionPrompt
        failed={{
          title: "Failed to retrieve status",
          text: loaderResponse?.statusText,
        }}
        submitting={{
          text: "Retrieving...",
          open: isRefreshing,
          setOpen: setIsRefreshing,
        }}
        submittedText="Status retrieved successfully"
        submissionStatus = {loaderResponse}
      /> */}
    </>
  );
}

export const StatusRoute = {
  name: "Status",
  path: "status",
};
